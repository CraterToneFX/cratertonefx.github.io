<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Muffs</title>
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/dark-sidebar.css">
</head>
<body>

<main>
  <article class="post">
    <h1>Muffs</h1>
    <div class="meta">January 08, 2026 Â· Fuzz</div>

    <p>The first big muff that I tried was the EHX NYC Big Muff. Maybe I should have tried something a little less...<br><br>
    <img src="/pics/EHX_NYC_Big_Muff.png" width="800px" height="377.4" alt="EHX NYC Big Muff"><br><br>
    It did work, sounded like it should just the output was low so I probably had something wrong or a poor solder joint etc.<br><br></p>
    <hr style="border: 2px solid grey; width: 80%; margin: 20px auto;"><br><br>
    <p>The next one was the EHX Big Muff 1977 OpAmp version.<br><br>
    <img src="/pics/EH Big Muff 1977 OpAmp.gif" width="594.5px" height="800" alt="EHX Big Muff OP Amp 77"><br><br>
    This one works great and is a great sounding muff.<br>
    Not sure who created this layout, you can find it hear and there. Looks like one from <a href="https://www.sabrotone.com/">Harold Sabro</a>.<br>
    His usually have his name at the top...so not sure.<br><br></p>
    <hr style="border: 2px solid grey; width: 80%; margin: 20px auto;"><br><br>
    <p>The next one was the EHX Big Muff 1978 Quad  OpAmp version.<br><br>
    <img src="/pics/EHX IC 78 Big Muff.png" width="600px" height="654.55" alt="EHX Big Muff Quad OP Amp 78"><br><br>
    This one works great also. It uses a quad op amp instead of 2 dual op amps, I thought this had a little coarser sound to it. Still sounds great tho.<br><br></p>
    <hr style="border: 2px solid grey; width: 80%; margin: 20px auto;"><br><br>
    <p>The next one is the Big Muff PI Ram's Head. I liked this one enough that it's the current one on my pedal board.<br><br>
    <img src="/pics/BigMuffPi-various.gif" width="800px" height="785.76" alt="Big Muff PI Ram's Head"><br><br>
    As you can see there are a lot of variations of Big Muff circuits. The Ram's Head is the only one I've tried so far out of this bunch.<br>
    This one is from <a href="https://www.sabrotone.com/">Harold Sabro</a> as you can see.<br><br></p>    
    
    <p><a href="/index.html">Back To Home</a></p>
    
  </article>

  <section id="comments">
  <h3>Comments</h3>

  <form id="comment-form">
    <input type="text" name="name" placeholder="Name" required>
    <textarea name="body" placeholder="Comment" required></textarea>

    <button type="submit">Post Comment</button>

  <div id="comment-list"></div> 
    
  </form>
</section>
<script>

const SUPABASE_URL = "https://zzkpinctabgkhpvcahyn.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp6a3BpbmN0YWJna2hwdmNhaHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NDAxNzAsImV4cCI6MjA4NjQxNjE3MH0.MQ6oiz3v0QUjhLqhVjtoZTnyjCBJLr0KW3uM3j3Fp6U";

const rawSlug = window.location.hostname + window.location.pathname;

const headers = {
  "Content-Type": "application/json",
  "apikey": SUPABASE_KEY,
  "Authorization": `Bearer ${SUPABASE_KEY}`
};

// Load comments with better debugging
console.log("Loading comments for:", rawSlug);

fetch(`${SUPABASE_URL}/rest/v1/comments?post_id=eq.${encodeURIComponent(rawSlug)}&approved=is.true&order=created_at.asc`, {
  headers
})
.then(res => {
  console.log("Response status:", res.status);
  return res.json();
})
.then(data => {
  console.log("Comments data:", data);
  
  if (!Array.isArray(data)) {
    console.error("Unexpected response format:", data);
    const list = document.getElementById("comment-list");
    list.innerHTML = "<p>Error loading comments</p>";
    return;
  }

  const list = document.getElementById("comment-list");
  
  if (data.length === 0) {
    list.innerHTML = "<p>No comments yet. Be the first!</p>";
    return;
  }

  list.innerHTML = "";
data.forEach(c => {
  const date = new Date(c.created_at).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
  
  list.innerHTML += `
    <div class="comment">
      <div class="comment-author">
        <strong>${escapeHtml(c.name || "Anonymous")}</strong>
        <div class="comment-date">${date}</div>
      </div>
      <p>${escapeHtml(c.body)}</p>
    </div>
  `;
});
})
.catch(err => {
  console.error("Load error:", err);
  document.getElementById("comment-list").innerHTML = "<p>Error loading comments</p>";
});

// Submit comment
document.getElementById("comment-form").addEventListener("submit", e => {
  e.preventDefault();

  const form = e.target;
  const name = form.name.value.trim();
  const body = form.body.value.trim();

  if (body.length < 3 || body.length > 2000) return;

  fetch(`${SUPABASE_URL}/rest/v1/comments`, {
    method: "POST",
    headers,
    body: JSON.stringify({
      post_id: rawSlug,
      name: name,
      body: body,
      approved: false
    })
  })
  .then(async res => {
    const text = await res.text();
    console.log("Insert status:", res.status);
    console.log("Insert response:", text);
    alert("Submitted for approval");
    form.reset();
  })
  .catch(err => console.error("Insert error:", err));
});

// Escape function
function escapeHtml(text) {
  return text.replace(/[&<>"']/g, function(m) {
    return ({
      "&": "&amp;",
      "<": "&lt;",
      ">": "&gt;",
      '"': "&quot;",
      "'": "&#039;"
    })[m];
  });
}
</script>

</main>

</body>
</html>
